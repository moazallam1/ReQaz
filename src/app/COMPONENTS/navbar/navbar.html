<nav class="bg-white shadow-sm sticky top-0 z-50" dir="rtl">
  <div class="max-w-7xl mx-auto px-6 py-4 flex items-center justify-between">
    <!-- Logo -->
    <a routerLink="/" class="text-2xl font-bold text-teal-600">ركاز</a>

    <!-- Desktop Navigation -->
    <div class="hidden md:flex items-center gap-8">
      <a routerLink="/" routerLinkActive="text-teal-600" [routerLinkActiveOptions]="{ exact: true }" class="text-gray-700 hover:text-teal-600 transition font-medium">
        الرئيسية
      </a>
      <a routerLink="/features" routerLinkActive="text-teal-600" class="text-gray-700 hover:text-teal-600 transition font-medium">
        المميزات
      </a>
      <a routerLink="/pricing" routerLinkActive="text-teal-600" class="text-gray-700 hover:text-teal-600 transition font-medium">
        الأسعار
      </a>
      <a routerLink="/contact" routerLinkActive="text-teal-600" class="text-gray-700 hover:text-teal-600 transition font-medium">
        تواصل معنا
      </a>
    </div>

    <!-- Auth Buttons / User Menu -->
    <div class="hidden md:flex items-center gap-4">
      <!-- Not Logged In -->
      @if (!isLoggedIn()) {
        <a routerLink="/login" class="px-4 py-2 text-teal-600 border border-teal-600 rounded-lg hover:bg-teal-50 transition font-medium">
          دخول
        </a>
        <a routerLink="/sign-up" class="px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition font-medium">
          إنشاء حساب
        </a>
        <!-- Test Button - Mock Login -->
        <button (click)="testLogin()" class="px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition font-medium text-sm">
          تجربة (مستخدم)
        </button>
        <button (click)="testAdminLogin()" class="px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-800 transition font-medium text-sm">
          تجربة (إدمن)
        </button>
      }

      <!-- Logged In -->
      @if (isLoggedIn()) {
        <!-- User Dashboard -->
        <button (click)="navigateToDashboard()" class="px-4 py-2 text-teal-600 hover:text-teal-700 transition font-medium">
          لوحة التحكم
        </button>

        <!-- Admin Panel (admin only) -->
        @if (isAdmin()) {
          <span class="px-2 py-1 bg-red-100 text-red-700 rounded text-xs font-bold">إدمن</span>
        }

        <!-- User Menu Dropdown -->
        <div class="relative group">
          <button class="flex items-center gap-2 px-4 py-2 hover:bg-gray-100 rounded-lg transition">
            <div class="w-8 h-8 bg-teal-600 rounded-full flex items-center justify-center text-white text-sm font-bold">
              {{ (currentUser()?.name ?? 'U').charAt(0) }}
            </div>
            <span class="text-gray-700 font-medium">{{ currentUser()?.name ?? 'المستخدم' }}</span>
            <span class="text-gray-500">▼</span>
          </button>

          <!-- Dropdown Menu -->
          <div class="absolute left-0 mt-0 w-48 bg-white rounded-lg shadow-lg hidden group-hover:block z-50 border border-gray-200">
            <a routerLink="/user/profile" class="block px-4 py-3 text-gray-700 hover:bg-gray-50 transition border-b border-gray-200">
              الملف الشخصي
            </a>
            <a href="#settings" class="block px-4 py-3 text-gray-700 hover:bg-gray-50 transition border-b border-gray-200">
              الإعدادات
            </a>
            <button (click)="logout()" class="w-full text-left px-4 py-3 text-red-600 hover:bg-red-50 transition">
              تسجيل الخروج
            </button>
          </div>
        </div>
      }
    </div>

    <!-- Mobile Menu Button -->
    <button (click)="toggleMobileMenu()" class="md:hidden flex flex-col gap-1.5">
      <span class="w-6 h-0.5 bg-gray-900 transition"></span>
      <span class="w-6 h-0.5 bg-gray-900 transition"></span>
      <span class="w-6 h-0.5 bg-gray-900 transition"></span>
    </button>
  </div>

  <!-- Mobile Menu -->
  @if (mobileMenuOpen) {
    <div class="md:hidden bg-white border-t border-gray-200">
      <div class="max-w-7xl mx-auto px-6 py-4 space-y-3">
        <a routerLink="/" class="block text-gray-700 hover:text-teal-600 transition font-medium py-2">
          الرئيسية
        </a>
        <a routerLink="/features" class="block text-gray-700 hover:text-teal-600 transition font-medium py-2">
          المميزات
        </a>
        <a routerLink="/pricing" class="block text-gray-700 hover:text-teal-600 transition font-medium py-2">
          الأسعار
        </a>
        <a routerLink="/contact" class="block text-gray-700 hover:text-teal-600 transition font-medium py-2">
          تواصل معنا
        </a>

        <div class="border-t border-gray-200 pt-4 mt-4">
          @if (!isLoggedIn()) {
            <div class="flex flex-col gap-2">
              <a routerLink="/login" class="px-4 py-2 text-center text-teal-600 border border-teal-600 rounded-lg transition">
                دخول
              </a>
              <a routerLink="/sign-up" class="px-4 py-2 text-center bg-teal-600 text-white rounded-lg transition">
                إنشاء حساب
              </a>
              <button (click)="testLogin()" class="px-4 py-2 text-center bg-gray-600 text-white rounded-lg transition text-sm">
                تجربة (مستخدم)
              </button>
              <button (click)="testAdminLogin()" class="px-4 py-2 text-center bg-gray-700 text-white rounded-lg transition text-sm">
                تجربة (إدمن)
              </button>
            </div>
          }

          @if (isLoggedIn()) {
            <div class="space-y-2">
              <button (click)="navigateToDashboard()" class="w-full text-left px-4 py-2 text-teal-600 hover:bg-teal-50 rounded-lg transition">
                لوحة التحكم
              </button>
              @if (isAdmin()) {
                <div class="px-4 py-2 text-red-600 text-sm font-bold">
                  (إدمن)
                </div>
              }
              <a routerLink="/user/profile" class="block px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition">
                الملف الشخصي
              </a>
              <button (click)="logout()" class="w-full text-left px-4 py-2 text-red-600 hover:bg-red-50 rounded-lg transition">
                تسجيل الخروج
              </button>
            </div>
          }
        </div>
      </div>
    </div>
  }
</nav>
